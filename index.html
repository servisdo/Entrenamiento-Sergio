<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Entrenos Sergio</title>
  <meta name="theme-color" content="#0a84ff" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-180.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="icon" href="icons/icon-192.png" type="image/png" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="mobile-header">
    <h1>Entrenos</h1>
    <div class="weekbar">
      <button id="prevWeek" class="btn icon" aria-label="Semana anterior">‹</button>
      <input type="date" id="weekStart" />
      <button id="nextWeek" class="btn icon" aria-label="Semana siguiente">›</button>
    </div>
    <div class="toolbar">
      <button id="newWeekBtn" class="btn">Nueva</button>
      <button id="duplicateWeekBtn" class="btn">Duplicar</button>
      <button id="exportAllBtn" class="btn">Exportar</button>
      <label class="fileBtn">Importar <input type="file" id="importAllFile" accept="application/json" /></label>
      <button id="resetBtn" class="btn">Reset</button>
    </div>
  </header>

  <nav class="bottom-tabs" role="tablist">
    <button class="tab active" data-tab="plan" aria-selected="true">Plan</button>
    <button class="tab" data-tab="historial" aria-selected="false">Historial</button>
    <button class="tab" data-tab="graficos" aria-selected="false">Gráficos</button>
  </nav>

  <main id="content">
    <section id="tab-plan" class="tab-pane active" role="tabpanel" aria-label="Plan">
      <div class="daylist-actions">
        <button id="expandAll" class="btn small">Expandir todo</button>
        <button id="collapseAll" class="btn small">Colapsar todo</button>
        <button id="exportWeekReport" class="btn small">Reporte semana</button>
      </div>

      <div id="planner"></div>

      <section id="biometrics" class="card">
        <h2>Biomarcadores</h2>
        <div class="bio-grid">
          <label>Peso (kg) <input type="number" id="peso" step="0.1" inputmode="decimal"></label>
          <label>Sueño (h) <input type="number" id="sueno" step="0.1" inputmode="decimal"></label>
          <label>Energía (1–5) <input type="number" id="energia" min="1" max="5" inputmode="numeric"></label>
          <label>Estrés (1–5) <input type="number" id="estres" min="1" max="5" inputmode="numeric"></label>
          <label>FC reposo (ppm) <input type="number" id="fcr" step="1" inputmode="numeric"></label>
          <label>Notas de sensaciones <textarea id="bioNotas" rows="3"></textarea></label>
        </div>
        <button id="saveBio" class="btn primary wide">Guardar biomarcadores</button>
      </section>

      <div class="fab-wrap">
        <button id="addBlockFab" class="fab" title="Añadir bloque">＋</button>
      </div>
    </section>

    <section id="tab-historial" class="tab-pane" role="tabpanel" aria-label="Historial">
      <div id="history"></div>
    </section>

    <section id="tab-graficos" class="tab-pane" role="tabpanel" aria-label="Gráficos">
      <div class="charts">
        <div class="chart-card card"><h3>Peso corporal por semana</h3><canvas id="pesoChart"></canvas></div>
        <div class="chart-card card"><h3>Volumen semanal (kg·reps)</h3><canvas id="volChart"></canvas></div>
        <div class="chart-card card"><h3>Caminata: tiempo total (min)</h3><canvas id="walkTimeChart"></canvas></div>
        <div class="chart-card card"><h3>Caminata: distancia total (km)</h3><canvas id="walkDistChart"></canvas></div>
      </div>
    </section>
  </main>

  <!-- Ventana emergente para resumen diario -->
  <div id="modalShare" class="modal hidden">
    <div class="modal-content card">
      <h3>Resumen diario</h3>
      <textarea id="shareTextarea" rows="10" readonly></textarea>
      <div class="modal-actions">
        <button id="shareCopy" class="btn small">Copiar</button>
        <button id="shareDownload" class="btn small">Descargar</button>
        <button id="shareClose" class="btn small">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Librería de gráficos -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Registro del Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js').catch(() => {});
      });
    }
  </script>

  <!-- Script principal -->
  <script src="script.js"></script>
</body>
</html>
